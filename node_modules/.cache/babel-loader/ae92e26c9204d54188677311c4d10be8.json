{"ast":null,"code":"import _regeneratorRuntime from\"/home/alejandro/Documents/Estudio/Projectos/PiscisfrontendBackup/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/alejandro/Documents/Estudio/Projectos/PiscisfrontendBackup/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/alejandro/Documents/Estudio/Projectos/PiscisfrontendBackup/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import loginService from'../services/loginService';import reservaService from'../services/reservaService';import LoginForm from'../componentes/LoginForm';import Notification from'../componentes/Notification';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),errorMessage=_useState2[0],setErrorMessage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];useEffect(function(){var loggedUserJSON=window.localStorage.getItem('loggedNoteAppUser');if(loggedUserJSON){var _user=JSON.parse(loggedUserJSON);setUser(_user);reservaService.setToken(_user.token);}},[]);var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var _user2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return loginService.login({username:username,password:password});case 4:_user2=_context.sent;window.localStorage.setItem('loggedNoteAppUser',JSON.stringify(_user2));reservaService.setToken(_user2.token);setUser(_user2);setUsername('');setPassword('');_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);setErrorMessage('Usuario o contraseña incorrectas');setTimeout(function(){setErrorMessage('');},5000);case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();function Link(){return window.location.href='./calendario';}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Notification,{message:errorMessage}),user?/*#__PURE__*/_jsx(Link,{}):/*#__PURE__*/_jsx(LoginForm,{username:username,password:password,handleUsernameChange:function handleUsernameChange(_ref2){var target=_ref2.target;return setUsername(target.value);},handlePasswordChange:function handlePasswordChange(_ref3){var target=_ref3.target;return setPassword(target.value);},handleSubmit:handleLogin})]});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","loginService","reservaService","LoginForm","Notification","Login","errorMessage","setErrorMessage","username","setUsername","password","setPassword","user","setUser","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","login","setItem","stringify","setTimeout","Link","location","href","target","value"],"sources":["/home/alejandro/Documents/Estudio/Projectos/PiscisfrontendBackup/src/pages/login.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\n\nimport loginService from '../services/loginService'\nimport reservaService from '../services/reservaService'\nimport LoginForm from '../componentes/LoginForm'\nimport Notification from '../componentes/Notification'\n\nconst Login = () => {\n  const [errorMessage, setErrorMessage] = useState(null)\n  const [username, setUsername] = useState()\n  const [password, setPassword] = useState()\n  const [user, setUser] = useState(null)\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedNoteAppUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      setUser(user)\n      reservaService.setToken(user.token)\n    }\n  }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      })\n\n      window.localStorage.setItem(\n        'loggedNoteAppUser', JSON.stringify(user)\n      )\n\n      reservaService.setToken(user.token)\n\n      setUser(user)\n      setUsername('')\n      setPassword('')\n    } catch (e) {\n      setErrorMessage('Usuario o contraseña incorrectas')\n      setTimeout(() => {\n        setErrorMessage('')\n      }, 5000)\n    }\n  }\n\n  function Link () {\n    return (\n      window.location.href = './calendario'\n    )\n  }\n\n  return (\n    <div>\n      <Notification message={errorMessage} />\n      {user\n        ? <Link />\n        : <LoginForm\n            username={username}\n            password={password}\n            handleUsernameChange={({ target }) => setUsername(target.value)}\n            handlePasswordChange={({ target }) => setPassword(target.value)}\n            handleSubmit={handleLogin}\n          />}\n    </div>\n  )\n}\n\nexport default Login\n"],"mappings":"kdAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAEA,MAAOC,aAAP,KAAyB,0BAAzB,CACA,MAAOC,eAAP,KAA2B,4BAA3B,CACA,MAAOC,UAAP,KAAsB,0BAAtB,CACA,MAAOC,aAAP,KAAyB,6BAAzB,C,wFAEA,GAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,CAClB,cAAwCL,QAAQ,CAAC,IAAD,CAAhD,wCAAOM,YAAP,eAAqBC,eAArB,eACA,eAAgCP,QAAQ,EAAxC,yCAAOQ,QAAP,eAAiBC,WAAjB,eACA,eAAgCT,QAAQ,EAAxC,yCAAOU,QAAP,eAAiBC,WAAjB,eACA,eAAwBX,QAAQ,CAAC,IAAD,CAAhC,yCAAOY,IAAP,eAAaC,OAAb,eAEAd,SAAS,CAAC,UAAM,CACd,GAAMe,eAAc,CAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,mBAA5B,CAAvB,CACA,GAAIH,cAAJ,CAAoB,CAClB,GAAMF,MAAI,CAAGM,IAAI,CAACC,KAAL,CAAWL,cAAX,CAAb,CACAD,OAAO,CAACD,KAAD,CAAP,CACAV,cAAc,CAACkB,QAAf,CAAwBR,KAAI,CAACS,KAA7B,EACD,CACF,CAPQ,CAON,EAPM,CAAT,CASA,GAAMC,YAAW,4FAAG,iBAAOC,KAAP,+HAClBA,KAAK,CAACC,cAAN,GADkB,sCAGGvB,aAAY,CAACwB,KAAb,CAAmB,CACpCjB,QAAQ,CAARA,QADoC,CAEpCE,QAAQ,CAARA,QAFoC,CAAnB,CAHH,QAGVE,MAHU,eAQhBG,MAAM,CAACC,YAAP,CAAoBU,OAApB,CACE,mBADF,CACuBR,IAAI,CAACS,SAAL,CAAef,MAAf,CADvB,EAIAV,cAAc,CAACkB,QAAf,CAAwBR,MAAI,CAACS,KAA7B,EAEAR,OAAO,CAACD,MAAD,CAAP,CACAH,WAAW,CAAC,EAAD,CAAX,CACAE,WAAW,CAAC,EAAD,CAAX,CAhBgB,iFAkBhBJ,eAAe,CAAC,kCAAD,CAAf,CACAqB,UAAU,CAAC,UAAM,CACfrB,eAAe,CAAC,EAAD,CAAf,CACD,CAFS,CAEP,IAFO,CAAV,CAnBgB,qEAAH,kBAAXe,YAAW,4CAAjB,CAyBA,QAASO,KAAT,EAAiB,CACf,MACEd,OAAM,CAACe,QAAP,CAAgBC,IAAhB,CAAuB,cADzB,CAGD,CAED,mBACE,oCACE,KAAC,YAAD,EAAc,OAAO,CAAEzB,YAAvB,EADF,CAEGM,IAAI,cACD,KAAC,IAAD,IADC,cAED,KAAC,SAAD,EACE,QAAQ,CAAEJ,QADZ,CAEE,QAAQ,CAAEE,QAFZ,CAGE,oBAAoB,CAAE,wCAAGsB,OAAH,OAAGA,MAAH,OAAgBvB,YAAW,CAACuB,MAAM,CAACC,KAAR,CAA3B,EAHxB,CAIE,oBAAoB,CAAE,wCAAGD,OAAH,OAAGA,MAAH,OAAgBrB,YAAW,CAACqB,MAAM,CAACC,KAAR,CAA3B,EAJxB,CAKE,YAAY,CAAEX,WALhB,EAJN,GADF,CAcD,CA5DD,CA8DA,cAAejB,MAAf"},"metadata":{},"sourceType":"module"}